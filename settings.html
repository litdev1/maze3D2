<!doctype html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>SB Maze Settings</title>
    <style>
        .row {
            display: flex;
        }

        .column {
            padding: 10px 10px 10px 0px;
        }
    </style>
</head>

<body>
    <div class="row">
        <div class="column">
            <label>Maze topology</label><br>
            <textarea id="maze" name="maze" rows="30" cols="30"></textarea><br>
            <br>
            <label>Speed multiplier</label>
            <input type="text" id="speed" name="speed" size="4"><br>
            <br>
            <label>Unique name</label>
            <input type="text" id="name" name="name" size="10"><br>
            <br>
            <label>Game</label>
            <input type="text" id="game" name="game" size="10"><br>
            <br>
            <button onclick="Maze3DDefaults()">Reset to defaults</button> 
            <button onclick="Maze3DSettings()">Apply settings</button><br><br>
            Reload &#39;SB Maze&#39; to see changes<br><br>
            <button onclick="ReloadMaze()">Apply and reload SB Maze</button><br>
        </div>
        <div class="column">
        </div>
        <div class="column">
            <label>Legend</label><br>
            <br>
            Each row of characters represent the maze cells in increasing (initially forwards) Z direction<br>
            The text characters within each row reresent the maze cells in the X (initially right) direction<br>
            <br>
            X is an active cell<br>
            An empty space is a walled cell<br>
            Y is an active cell initially with a Yeti<br>
            L is an active cell with a light<br>
            a is an active cell with wall art (bug)<br>
            b is an active cell with wall art (smiley)<br>
            c is an active cell with wall art (tree)<br>
            d is an active cell with wall art (coffee)<br>
            <br>
            Default Yeti speed is 1 cell/s<br>
            Default robot speed is 1.5 cell/s<br>
            Default manual (left/right) rotation is 1.5 radians/s (~86 deg/s)<br>
            Default automatic 90 deg rotation (0.5 s)<br>
            <br>
            The optional 'unique name' identifies a specific user, which can be useful when users are sharing the same
            IP address<br>
            In this case the first web argument sent from SB should match this name<br>
            (e.g. https://litdev.uk/apps/maze3D/maze3D.php?name=Steve&action=get")<br><br>
            There is also a special user called 'Observer' that can fly out of the maze for an overview and takes no
            part in any game<br>
            <br>
            The optional 'game' identifies a maze world in which only robot players using the same game will be
            shown<br>
        </div>
    </div>

    <script>
        Maze3DInitial();

        function Maze3DInitial() {
            maze = JSON.parse(localStorage.getItem('maze'));
            if (maze == null) {
                Maze3DDefaults();
            }
            else {
                maze.reverse();
                maze = `${maze.join('\n')}`;
                document.getElementById('maze').value = maze;
                document.getElementById('speed').value = JSON.parse(localStorage.getItem('speed'));
                document.getElementById('name').value = JSON.parse(localStorage.getItem('name'));
                document.getElementById('game').value = JSON.parse(localStorage.getItem('game'));
            }
        }

        function Maze3DDefaults() {
            document.getElementById('maze').value =
                "XXXc XXXXYXXXXdXXXL\n" +
                "a  XXXX\n" +
                "X XXc X XaX\n" +
                "XbX XYXX XX\n" +
                "       d XX\n" +
                "XXcX XLXXXX\n" +
                " L X X\n" +
                " X  XXXXXX\n" +
                "YXXYXXXX LX\n" +
                "b X   X   d\n" +
                "XXXcXXXbXXX";
            document.getElementById('speed').value = 1;
            document.getElementById('name').value = "";
            document.getElementById('game').value = "";
            Maze3DSettings();
        }

        function Maze3DSettings() {
            maze = document.getElementById('maze').value.split('\n');
            maze.reverse();
            localStorage.setItem('maze', JSON.stringify(maze));
            speed = document.getElementById('speed').value;
            localStorage.setItem('speed', JSON.stringify(speed));
            name = document.getElementById('name').value;
            localStorage.setItem('name', JSON.stringify(name));
            game = document.getElementById('game').value;
            localStorage.setItem('game', JSON.stringify(game));
        }

        function ReloadMaze() {
            Maze3DSettings();
            window.location.href = "index.html";
        }
    </script>
</body>

</html>